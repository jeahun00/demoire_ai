name: demoire_ai_01
model_type: MoCHAformer_Stg1_Model
num_gpu: 1  # set num_gpu: 0 for cpu mode
manual_seed: 0

datasets:
  test:
    name: MultiFrameVD
    type: MultiFrameVDPairedRawTestDataset
    dataroot_gt: /code/RawVDemoire_test/gt_rgb
    dataroot_lq: /code/RawVDemoire_test/moire_raw
    io_backend:
      type: disk
    batch_size: 1
    num_worker: 8

# network structures
network_g:
  type: MoCHAformer4
  stage: 1
  convnext_block_c: 3
  convnext_block_m: 3
  img_size: 128
  patch_size: 1
  in_chans: 4
  embed_dim: 96
  depths: [3,3,3]
  num_heads: [4,4,4]
  window_size: [2,7,7]
  mlp_ratio: 2
  qkv_bias: True
  qk_scale: False
  drop_rate: 0.
  attn_drop_rate: 0.
  drop_path_rate: 0.1
  ape: False
  patch_norm: True
  use_checkpoint: False
  upscale: 1
  img_range: 1.
  upsampler: 'pixelshuffle'
  downsample: True


# path
path:
  pretrain_network_g: experiments/demoire_ai_01/models/net_g_120000.pth
  strict_load_g: false
  param_key_g: 'params_ema'


# validation settings
val:
  save_img: true
  metrics:
    psnr:
      type: calculate_vd_psnr
    ssim:
      type: calculate_vd_ssim
    lpips:
      type: calculate_vd_lpips

